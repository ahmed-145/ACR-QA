rules:
  - id: dangerous-eval-usage
    pattern-either:
      - pattern: eval($X)
      - pattern: exec($X)
    message: |
      Dangerous use of eval() or exec(). These functions execute arbitrary 
      Python code and should NEVER be used with user input.
    severity: ERROR
    languages: [python]
    metadata:
      category: security

  - id: sql-injection-string-concat
    pattern-either:
      - pattern: $CURSOR.execute("..." + $VAR + "...")
      - pattern: $CURSOR.execute(f"...{$VAR}...")
    message: |
      Possible SQL injection vulnerability. Use parameterized queries instead.
    severity: ERROR
    languages: [python]
    metadata:
      category: security

  - id: mutable-default-argument
    pattern-either:
      - pattern: |
          def $FUNC(..., $ARG=[], ...):
            ...
      - pattern: |
          def $FUNC(..., $ARG={}, ...):
            ...
    message: |
      Mutable default argument detected! This is a classic Python bug.
      Default values are created ONCE when the function is defined.
    severity: ERROR
    languages: [python]
    metadata:
      category: best-practice
